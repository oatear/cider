<p-dialog header="New Template Wizard" [(visible)]="visible" (visibleChange)="visibleChange.emit($event)"
    (onHide)="hideDialog()" [styleClass]="'template-dialog'" focusOnShow="false"
    [modal]="true" [style]="{width: '600px'}" [closable]="true">
    <ng-template pTemplate="content">

        <p-stepper [value]="1">
            <p-step-list>
                <p-step [value]="1">Card Size</p-step>
                <p-step [value]="2">Layout</p-step>
                <p-step [value]="3">Preview</p-step>
            </p-step-list>
            <p-step-panels>
                <p-step-panel [value]="1" [id]="'size-panel'">
                    <ng-template #content let-activateCallback="activateCallback">
                        <div class="card-list">
                            <p-selectbutton [options]="sizeCards" [(ngModel)]="selectedSize" 
                                (onChange)="selectedSizeChange($event)"
                                optionLabel="key" [style]="{width: '100%'}">
                                <ng-template #item let-item>
                                    <app-card-preview [cache]="false" [card]="item" [scale]="zoomLevel" 
                                        [template]="item.frontCardTemplate"></app-card-preview>
                                    <span>{{item.key}}</span>
                                </ng-template>
                            </p-selectbutton>
                        </div>
                        <div class="step-controls p-justify-end">
                            <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" 
                                (onClick)="activateCallback(2)" />
                        </div>
                    </ng-template>
                </p-step-panel>

                <p-step-panel [value]="2" [id]="'layout-panel'">
                    <ng-template #content let-activateCallback="activateCallback">
                        <div class="card-list">
                            <p-selectbutton [options]="layoutCards" [(ngModel)]="selectedLayout" 
                                optionLabel="key" [style]="{width: '100%'}">
                                <ng-template #item let-item>
                                    <app-card-preview [cache]="false" [card]="item" [scale]="zoomLevel" 
                                        [template]="item.frontCardTemplate"></app-card-preview>
                                    <span>{{item.key}}</span>
                                </ng-template>
                            </p-selectbutton>
                        </div>
                        <div class="step-controls p-justify-between">
                            <p-button label="Back" severity="secondary" icon="pi pi-arrow-left" (onClick)="activateCallback(1)" />
                            <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(3)" />
                        </div>
                    </ng-template>
                </p-step-panel>

                <p-step-panel [value]="3" [id]="'preview-panel'">
                    <ng-template #content let-activateCallback="activateCallback">
                        <div class="card-preview">
                            <app-card-preview [cache]="false" [card]="selectedLayout" 
                                [scale]="0.25" [template]="selectedLayout.frontCardTemplate"></app-card-preview>
                        </div>
                        <div class="step-controls p-justify-between">
                            <p-button label="Back" severity="secondary" icon="pi pi-arrow-left" (onClick)="activateCallback(2)" />
                            <p-button label="Create" severity="success" (onClick)="createTemplate()" />
                        </div>
                    </ng-template>
                </p-step-panel>
            </p-step-panels>
        </p-stepper>

    </ng-template>
</p-dialog>
